var app=function(){"use strict";function t(){}function e(t){return t()}function n(){return Object.create(null)}function o(t){t.forEach(e)}function r(t){return"function"==typeof t}function l(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function c(e,n,o){e.$$.on_destroy.push(function(e,...n){if(null==e)return t;const o=e.subscribe(...n);return o.unsubscribe?()=>o.unsubscribe():o}(n,o))}function s(t){return null==t?"":t}function i(t,e){t.appendChild(e)}function a(t,e,n){t.insertBefore(e,n||null)}function u(t){t.parentNode&&t.parentNode.removeChild(t)}function f(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function g(t){return document.createElement(t)}function $(t){return document.createTextNode(t)}function d(){return $(" ")}function m(){return $("")}function p(t,e,n,o){return t.addEventListener(e,n,o),()=>t.removeEventListener(e,n,o)}function h(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function b(t,e){e=""+e,t.data!==e&&(t.data=e)}function v(t,e){t.value=null==e?"":e}function y(t,e,n,o){null==n?t.style.removeProperty(e):t.style.setProperty(e,n,o?"important":"")}function w(t,e){return new t(e)}let k;function C(t){k=t}function x(t,e){const n=t.$$.callbacks[e.type];n&&n.slice().forEach((t=>t.call(this,e)))}const _=[],E=[];let S=[];const T=[],z=Promise.resolve();let N=!1;function O(t){S.push(t)}const P=new Set;let j=0;function H(){if(0!==j)return;const t=k;do{try{for(;j<_.length;){const t=_[j];j++,C(t),D(t.$$)}}catch(t){throw _.length=0,j=0,t}for(C(null),_.length=0,j=0;E.length;)E.pop()();for(let t=0;t<S.length;t+=1){const e=S[t];P.has(e)||(P.add(e),e())}S.length=0}while(_.length);for(;T.length;)T.pop()();N=!1,P.clear(),C(t)}function D(t){if(null!==t.fragment){t.update(),o(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(O)}}const L=new Set;let M;function A(){M={r:0,c:[],p:M}}function J(){M.r||o(M.c),M=M.p}function R(t,e){t&&t.i&&(L.delete(t),t.i(e))}function B(t,e,n,o){if(t&&t.o){if(L.has(t))return;L.add(t),M.c.push((()=>{L.delete(t),o&&(n&&t.d(1),o())})),t.o(e)}else o&&o()}function F(t){t&&t.c()}function G(t,n,l,c){const{fragment:s,after_update:i}=t.$$;s&&s.m(n,l),c||O((()=>{const n=t.$$.on_mount.map(e).filter(r);t.$$.on_destroy?t.$$.on_destroy.push(...n):o(n),t.$$.on_mount=[]})),i.forEach(O)}function I(t,e){const n=t.$$;null!==n.fragment&&(!function(t){const e=[],n=[];S.forEach((o=>-1===t.indexOf(o)?e.push(o):n.push(o))),n.forEach((t=>t())),S=e}(n.after_update),o(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function q(t,e){-1===t.$$.dirty[0]&&(_.push(t),N||(N=!0,z.then(H)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function U(e,r,l,c,s,i,a,f=[-1]){const g=k;C(e);const $=e.$$={fragment:null,ctx:[],props:i,update:t,not_equal:s,bound:n(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(r.context||(g?g.$$.context:[])),callbacks:n(),dirty:f,skip_bound:!1,root:r.target||g.$$.root};a&&a($.root);let d=!1;if($.ctx=l?l(e,r.props||{},((t,n,...o)=>{const r=o.length?o[0]:n;return $.ctx&&s($.ctx[t],$.ctx[t]=r)&&(!$.skip_bound&&$.bound[t]&&$.bound[t](r),d&&q(e,t)),n})):[],$.update(),d=!0,o($.before_update),$.fragment=!!c&&c($.ctx),r.target){if(r.hydrate){const t=function(t){return Array.from(t.childNodes)}(r.target);$.fragment&&$.fragment.l(t),t.forEach(u)}else $.fragment&&$.fragment.c();r.intro&&R(e.$$.fragment),G(e,r.target,r.anchor,r.customElement),H()}C(g)}class K{$destroy(){I(this,1),this.$destroy=t}$on(e,n){if(!r(n))return t;const o=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return o.push(n),()=>{const t=o.indexOf(n);-1!==t&&o.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}function Q(e){let n,o,r,l;return{c(){n=g("button"),o=$(e[0]),y(n,"background-color",e[1]),h(n,"class","svelte-13wc0f2")},m(t,c){a(t,n,c),i(n,o),r||(l=p(n,"click",e[2]),r=!0)},p(t,[e]){1&e&&b(o,t[0]),2&e&&y(n,"background-color",t[1])},i:t,o:t,d(t){t&&u(n),r=!1,l()}}}function V(t,e,n){let{symbol:o}=e,{bgColor:r}=e;return t.$$set=t=>{"symbol"in t&&n(0,o=t.symbol),"bgColor"in t&&n(1,r=t.bgColor)},[o,r,function(e){x.call(this,t,e)}]}class W extends K{constructor(t){super(),U(this,t,V,Q,l,{symbol:0,bgColor:1})}}const X=[];function Y(e,n=t){let o;const r=new Set;function c(t){if(l(e,t)&&(e=t,o)){const t=!X.length;for(const t of r)t[1](),X.push(t,e);if(t){for(let t=0;t<X.length;t+=2)X[t][0](X[t+1]);X.length=0}}}return{set:c,update:function(t){c(t(e))},subscribe:function(l,s=t){const i=[l,s];return r.add(i),1===r.size&&(o=n(c)||t),l(e),()=>{r.delete(i),0===r.size&&o&&(o(),o=null)}}}}let Z=Y("");function tt(t){var e=new Date(t);return e.getHours()+":"+("0"+e.getMinutes()).slice(-2)+":"+("0"+e.getSeconds()).slice(-2)}const et=document.location.origin+document.location.pathname;function nt(t,e,n){const o=t.slice();return o[26]=e[n],o}function ot(t){let e,n,o,r,l,c=t[26].rider+"",s=lt(t[26].time)+"";return{c(){e=g("tr"),n=g("td"),o=$(c),r=g("td"),l=$(s)},m(t,c){a(t,e,c),i(e,n),i(n,o),i(e,r),i(r,l)},p(t,e){2&e&&c!==(c=t[26].rider+"")&&b(o,c),2&e&&s!==(s=lt(t[26].time)+"")&&b(l,s)},d(t){t&&u(e)}}}function rt(t){let e,n,o,r,l,c,s,m,p,v,w,k,C,x,_,E,S,T,z,N,O,P,j,H,D,L,M,A,J,q,U,K,Q,V,X,Y,Z,tt,et,rt,lt,ct,st,it,at,ut,ft,gt,$t,dt,mt,pt,ht,bt,vt,yt,wt,kt,Ct;E=new W({props:{symbol:"7",bgColor:"#39c41f"}}),E.$on("click",t[8]),z=new W({props:{symbol:"8",bgColor:"#39c41f"}}),z.$on("click",t[9]),P=new W({props:{symbol:"9",bgColor:"#39c41f"}}),P.$on("click",t[10]),L=new W({props:{symbol:"4",bgColor:"#39c41f"}}),L.$on("click",t[11]),J=new W({props:{symbol:"5",bgColor:"#39c41f"}}),J.$on("click",t[12]),K=new W({props:{symbol:"6",bgColor:"#39c41f"}}),K.$on("click",t[13]),Y=new W({props:{symbol:"1",bgColor:"#39c41f"}}),Y.$on("click",t[14]),et=new W({props:{symbol:"2",bgColor:"#39c41f"}}),et.$on("click",t[15]),ct=new W({props:{symbol:"3",bgColor:"#39c41f"}}),ct.$on("click",t[16]),gt=new W({props:{symbol:"0",bgColor:"#39c41f"}}),gt.$on("click",t[17]),ht=new W({props:{symbol:"clear",bgColor:"#C4391f"}}),ht.$on("click",t[18]),vt=new W({props:{symbol:"FINISH!",bgColor:"#391fc4"}}),vt.$on("click",t[19]);let xt=t[1],_t=[];for(let e=0;e<xt.length;e+=1)_t[e]=ot(nt(t,xt,e));return{c(){e=g("main"),n=g("div"),o=$("event:  "),r=$(t[3]),l=d(),c=g("div"),s=g("b"),m=g("h1"),p=$("#: "),v=$(t[2]),w=d(),k=g("div"),C=g("table"),x=g("tr"),_=g("td"),F(E.$$.fragment),S=d(),T=g("td"),F(z.$$.fragment),N=d(),O=g("td"),F(P.$$.fragment),j=d(),H=g("tr"),D=g("td"),F(L.$$.fragment),M=d(),A=g("td"),F(J.$$.fragment),q=d(),U=g("td"),F(K.$$.fragment),Q=d(),V=g("tr"),X=g("td"),F(Y.$$.fragment),Z=d(),tt=g("td"),F(et.$$.fragment),rt=d(),lt=g("td"),F(ct.$$.fragment),st=d(),it=g("tr"),at=g("td"),ut=d(),ft=g("td"),F(gt.$$.fragment),$t=d(),dt=g("td"),mt=d(),pt=g("div"),F(ht.$$.fragment),bt=d(),F(vt.$$.fragment),yt=d(),wt=g("div"),kt=g("table");for(let t=0;t<_t.length;t+=1)_t[t].c();h(m,"class","svelte-1kzfk1w"),h(C,"class","svelte-1kzfk1w"),y(pt,"margin-block-start","8px"),h(kt,"cellpadding","3"),h(kt,"class","svelte-1kzfk1w"),h(e,"class","svelte-1kzfk1w")},m(t,u){a(t,e,u),i(e,n),i(n,o),i(n,r),i(e,l),i(e,c),i(c,s),i(s,m),i(m,p),i(m,v),i(e,w),i(e,k),i(k,C),i(C,x),i(x,_),G(E,_,null),i(x,S),i(x,T),G(z,T,null),i(x,N),i(x,O),G(P,O,null),i(C,j),i(C,H),i(H,D),G(L,D,null),i(H,M),i(H,A),G(J,A,null),i(H,q),i(H,U),G(K,U,null),i(H,Q),i(C,V),i(V,X),G(Y,X,null),i(V,Z),i(V,tt),G(et,tt,null),i(V,rt),i(V,lt),G(ct,lt,null),i(C,st),i(C,it),i(it,at),i(it,ut),i(it,ft),G(gt,ft,null),i(it,$t),i(it,dt),i(e,mt),i(e,pt),G(ht,pt,null),i(pt,bt),G(vt,pt,null),i(e,yt),i(e,wt),i(wt,kt);for(let t=0;t<_t.length;t+=1)_t[t]&&_t[t].m(kt,null);Ct=!0},p(t,[e]){if((!Ct||8&e)&&b(r,t[3]),(!Ct||4&e)&&b(v,t[2]),3&e){let n;for(xt=t[1],n=0;n<xt.length;n+=1){const o=nt(t,xt,n);_t[n]?_t[n].p(o,e):(_t[n]=ot(o),_t[n].c(),_t[n].m(kt,null))}for(;n<_t.length;n+=1)_t[n].d(1);_t.length=xt.length}},i(t){Ct||(R(E.$$.fragment,t),R(z.$$.fragment,t),R(P.$$.fragment,t),R(L.$$.fragment,t),R(J.$$.fragment,t),R(K.$$.fragment,t),R(Y.$$.fragment,t),R(et.$$.fragment,t),R(ct.$$.fragment,t),R(gt.$$.fragment,t),R(ht.$$.fragment,t),R(vt.$$.fragment,t),Ct=!0)},o(t){B(E.$$.fragment,t),B(z.$$.fragment,t),B(P.$$.fragment,t),B(L.$$.fragment,t),B(J.$$.fragment,t),B(K.$$.fragment,t),B(Y.$$.fragment,t),B(et.$$.fragment,t),B(ct.$$.fragment,t),B(gt.$$.fragment,t),B(ht.$$.fragment,t),B(vt.$$.fragment,t),Ct=!1},d(t){t&&u(e),I(E),I(z),I(P),I(L),I(J),I(K),I(Y),I(et),I(ct),I(gt),I(ht),I(vt),f(_t,t)}}}function lt(t){var e=new Date(t);return e.getHours()+":"+("0"+e.getMinutes()).slice(-2)+":"+("0"+e.getSeconds()).slice(-2)}function ct(t,e,n){let o;c(t,Z,(t=>n(7,o=t)));var r=et+"api/event",l=[],s="",i="";const a=new URLSearchParams(document.location.search).get("guid");function u(t){n(2,s+=t)}async function f(){if(s.length<1)return;let t=new Date,e=t.getTime();console.log("rider "+s+" finished at "+e),t.getHours(),("0"+t.getMinutes()).slice(-2),("0"+t.getSeconds()).slice(-2);let c={rider:s,time:e};await fetch(r+"/"+o,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...c})}),n(2,s=""),console.log("recent finishers ",l)}function g(){n(2,s="")}null!=a&&(Z.update((t=>a)),async function(){const t=await fetch(r+"/"+o,{method:"GET"});if(!t.ok){if(404==t.status)return alert("Sorry, we don't recognize that event. Sending you to create a new one."),void $t.update((t=>2));throw new Error(`HTTP error! status: ${t.status}`)}var e=await t.json();const c=e.finishes;console.log("all are ",c);const s=c.slice(Math.max(c.length-5,0));n(3,i=e.name),document.title=i,n(1,l=s),console.log("the last five are ",s)}());return t.$$.update=()=>{128&t.$$.dirty&&(o.length<4||new EventSource(r+"/stream/"+o).addEventListener("newFinish",(t=>{const e=JSON.parse(t.data),o=l.slice(-4);n(1,l=[...o,e]),console.log("got a typed message of ",e)})))},[lt,l,s,i,u,f,g,o,()=>u(7),()=>u(8),()=>u(9),()=>u(4),()=>u(5),()=>u(6),()=>u(1),()=>u(2),()=>u(3),()=>u(0),()=>g(),()=>f()]}function st(t){let e,n,o,r,l,c,s,f,$;return c=new W({props:{symbol:"Create",bgColor:"#C4C41f"}}),c.$on("click",t[3]),{c(){e=g("main"),n=g("div"),o=g("input"),r=d(),l=g("div"),F(c.$$.fragment),h(o,"id","event_name"),h(o,"type","text"),h(e,"class","svelte-1kzfk1w")},m(u,g){a(u,e,g),i(e,n),i(n,o),v(o,t[0]),i(e,r),i(e,l),G(c,l,null),s=!0,f||($=p(o,"input",t[2]),f=!0)},p(t,[e]){1&e&&o.value!==t[0]&&v(o,t[0])},i(t){s||(R(c.$$.fragment,t),s=!0)},o(t){B(c.$$.fragment,t),s=!1},d(t){t&&u(e),I(c),f=!1,$()}}}function it(t,e,n){let o;c(t,Z,(t=>n(4,o=t)));var r=et+"api/event";let l="";async function s(){var t={name:l},e=JSON.stringify({...t});console.log("attempting to create a new event "+r,e);const n=await fetch(r,{method:"POST",mode:"cors",headers:{"Content-Type":"application/json"},body:e});if(!n.ok)throw new Error(`HTTP error! status: ${response.status}`);n.headers.get("Date"),n.headers.get("Location");var c=await n.json();Z.update((t=>c)),console.log("event created, guid="+o),document.location.assign(et+"?guid="+o)}return[l,s,function(){l=this.value,n(0,l)},()=>s()]}function at(t,e,n){const o=t.slice();return o[5]=e[n],o}function ut(t){let e,n,o,r,l,c=t[5].rider+"",s=tt(t[5].time)+"";return{c(){e=g("tr"),n=g("td"),o=$(c),r=g("td"),l=$(s)},m(t,c){a(t,e,c),i(e,n),i(n,o),i(e,r),i(r,l)},p(t,e){2&e&&c!==(c=t[5].rider+"")&&b(o,c),2&e&&s!==(s=tt(t[5].time)+"")&&b(l,s)},d(t){t&&u(e)}}}function ft(e){let n,o,r,l,c,s,m,p,v=e[1],y=[];for(let t=0;t<v.length;t+=1)y[t]=ut(at(e,v,t));return{c(){n=g("main"),o=g("div"),r=$(e[0]),l=d(),c=g("div"),s=g("table"),m=g("tr"),m.innerHTML="<th>rider</th><th>time</th>",p=d();for(let t=0;t<y.length;t+=1)y[t].c();h(s,"class","svelte-1kzfk1w"),h(n,"class","svelte-1kzfk1w")},m(t,e){a(t,n,e),i(n,o),i(o,r),i(n,l),i(n,c),i(c,s),i(s,m),i(s,p);for(let t=0;t<y.length;t+=1)y[t]&&y[t].m(s,null)},p(t,[e]){if(1&e&&b(r,t[0]),2&e){let n;for(v=t[1],n=0;n<v.length;n+=1){const o=at(t,v,n);y[n]?y[n].p(o,e):(y[n]=ut(o),y[n].c(),y[n].m(s,null))}for(;n<y.length;n+=1)y[n].d(1);y.length=v.length}},i:t,o:t,d(t){t&&u(n),f(y,t)}}}function gt(t,e,n){let o;c(t,Z,(t=>n(2,o=t)));var r=et+"api/event";let l="",s=[];return async function(){var t=r+"/processed/"+o;console.log("attempting",t);const e=await fetch(t,{method:"GET"});if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);var c=await e.json();n(0,l=c.name),n(1,s=c.finishes)}(),[l,s]}let $t=Y(1),dt=[{label:"Record",value:1,component:class extends K{constructor(t){super(),U(this,t,ct,rt,l,{prettyDate:0})}get prettyDate(){return lt}}},{label:"Create",value:2,component:class extends K{constructor(t){super(),U(this,t,it,st,l,{})}}},{label:"Result",value:3,component:class extends K{constructor(t){super(),U(this,t,gt,ft,l,{})}}}];function mt(t,e,n){const o=t.slice();return o[3]=e[n],o}function pt(t,e,n){const o=t.slice();return o[3]=e[n],o}function ht(t){let e,n,o,l,c,f,m,v=t[3].label+"";return{c(){e=g("li"),n=g("span"),o=$(v),l=d(),h(n,"class","svelte-y14wsi"),h(e,"class",c=s(t[1]===t[3].value?"active":"")+" svelte-y14wsi")},m(c,s){a(c,e,s),i(e,n),i(n,o),i(e,l),f||(m=p(n,"click",(function(){r(t[2](t[3].value))&&t[2](t[3].value).apply(this,arguments)})),f=!0)},p(n,r){t=n,1&r&&v!==(v=t[3].label+"")&&b(o,v),3&r&&c!==(c=s(t[1]===t[3].value?"active":"")+" svelte-y14wsi")&&h(e,"class",c)},d(t){t&&u(e),f=!1,m()}}}function bt(t){let e,n,o,r;var l=t[3].component;return l&&(n=w(l,{})),{c(){e=g("div"),n&&F(n.$$.fragment),o=d(),h(e,"class","box svelte-y14wsi")},m(t,l){a(t,e,l),n&&G(n,e,null),i(e,o),r=!0},p(t,r){if(1&r&&l!==(l=t[3].component)){if(n){A();const t=n;B(t.$$.fragment,1,0,(()=>{I(t,1)})),J()}l?(n=w(l,{}),F(n.$$.fragment),R(n.$$.fragment,1),G(n,e,o)):n=null}},i(t){r||(n&&R(n.$$.fragment,t),r=!0)},o(t){n&&B(n.$$.fragment,t),r=!1},d(t){t&&u(e),n&&I(n)}}}function vt(t){let e,n,o=t[1]==t[3].value&&bt(t);return{c(){o&&o.c(),e=m()},m(t,r){o&&o.m(t,r),a(t,e,r),n=!0},p(t,n){t[1]==t[3].value?o?(o.p(t,n),3&n&&R(o,1)):(o=bt(t),o.c(),R(o,1),o.m(e.parentNode,e)):o&&(A(),B(o,1,1,(()=>{o=null})),J())},i(t){n||(R(o),n=!0)},o(t){B(o),n=!1},d(t){o&&o.d(t),t&&u(e)}}}function yt(t){let e,n,o,r,l=t[0],c=[];for(let e=0;e<l.length;e+=1)c[e]=ht(pt(t,l,e));let s=t[0],i=[];for(let e=0;e<s.length;e+=1)i[e]=vt(mt(t,s,e));const $=t=>B(i[t],1,1,(()=>{i[t]=null}));return{c(){e=g("ul");for(let t=0;t<c.length;t+=1)c[t].c();n=d();for(let t=0;t<i.length;t+=1)i[t].c();o=m(),h(e,"class","svelte-y14wsi")},m(t,l){a(t,e,l);for(let t=0;t<c.length;t+=1)c[t]&&c[t].m(e,null);a(t,n,l);for(let e=0;e<i.length;e+=1)i[e]&&i[e].m(t,l);a(t,o,l),r=!0},p(t,[n]){if(7&n){let o;for(l=t[0],o=0;o<l.length;o+=1){const r=pt(t,l,o);c[o]?c[o].p(r,n):(c[o]=ht(r),c[o].c(),c[o].m(e,null))}for(;o<c.length;o+=1)c[o].d(1);c.length=l.length}if(3&n){let e;for(s=t[0],e=0;e<s.length;e+=1){const r=mt(t,s,e);i[e]?(i[e].p(r,n),R(i[e],1)):(i[e]=vt(r),i[e].c(),R(i[e],1),i[e].m(o.parentNode,o))}for(A(),e=s.length;e<i.length;e+=1)$(e);J()}},i(t){if(!r){for(let t=0;t<s.length;t+=1)R(i[t]);r=!0}},o(t){i=i.filter(Boolean);for(let t=0;t<i.length;t+=1)B(i[t]);r=!1},d(t){t&&u(e),f(c,t),t&&u(n),f(i,t),t&&u(o)}}}function wt(t,e,n){let o;c(t,$t,(t=>n(1,o=t)));let{tabitems:r=[]}=e;return t.$$set=t=>{"tabitems"in t&&n(0,r=t.tabitems)},[r,o,t=>()=>$t.update((e=>t))]}class kt extends K{constructor(t){super(),U(this,t,wt,yt,l,{tabitems:0})}}function Ct(e){let n,o;return n=new kt({props:{tabitems:dt}}),{c(){F(n.$$.fragment)},m(t,e){G(n,t,e),o=!0},p:t,i(t){o||(R(n.$$.fragment,t),o=!0)},o(t){B(n.$$.fragment,t),o=!1},d(t){I(n,t)}}}return new class extends K{constructor(t){super(),U(this,t,null,Ct,l,{})}}({target:document.body})}();
//# sourceMappingURL=bundle.js.map
